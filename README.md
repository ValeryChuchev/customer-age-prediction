# Определение возраста покупателей по фотографии

##  О проекте

Проект по разработке системы компьютерного зрения для сетевого супермаркета "Хлеб-Соль". Система анализирует фотографии покупателей в прикассовой зоне и определяет их возраст для улучшения сервиса и контроля продаж.

## Цели проекта

- Построение модели для определения возраста по фотографии
- Достижение средней абсолютной ошибки (MAE) ≤ 8 лет
- Анализ возрастного распределения покупателей
- Создание прототипа системы для интеграции с кассовыми терминалами

##  Данные

### Источник данных:
Набор фотографий людей с указанием возраста

### Характеристики датасета:
- **Объем**: 7,591 изображений
- **Возрастной диапазон**: от 1 до 100 лет
- **Средний возраст**: 31.2 года
- **Разрешение изображений**: приведено к 224x224 пикселей
- **Формат**: RGB с нормализацией пикселей [0, 1]

##  Технологии

- **Python 3.8+**
- **TensorFlow/Keras** - глубокое обучение
- **OpenCV** - обработка изображений
- **ResNet50** - предобученная архитектура CNN
- **Transfer Learning** - дообучение модели
- **Matplotlib/Seaborn** - визуализация
- **Pandas/NumPy** - анализ данных

##  Ключевые этапы работы

### 1. Исследовательский анализ данных
- Анализ распределения возрастов в датасете
- Визуализация примеров изображений
- Статистический анализ меток (среднее, медиана, стандартное отклонение)
- Проверка качества и согласованности данных

### 2. Подготовка данных
- Нормализация пикселей в диапазон [0, 1]
- Изменение размера изображений до 224x224 пикселей
- Разделение на обучающую и валидационную выборки (80/20)
- Создание генераторов данных с аугментацией

### 3. Построение модели

#### Архитектура:
- **Базовая модель**: ResNet50 с предобученными весами (ImageNet)
- **Transfer Learning**: Заморозка начальных слоев, дообучение верхних
- **Выходной слой**: Полносвязный слой с 1 нейроном (регрессия)

#### Параметры обучения:
- **Оптимизатор**: Adam
- **Функция потерь**: Mean Absolute Error (MAE)
- **Метрики**: MAE, MSE
- **Размер батча**: 32
- **Эпохи**: 10 (с ранней остановкой)

### 4. Обучение и валидация
- Мониторинг процесса обучения
- Анализ кривых обучения и валидации
- Проверка на переобучение
- Подбор оптимального количества эпох

##  Результаты

### Качество модели:
- **MAE на обучении**: 5.07 лет
- **MAE на валидации**: 6.82 лет
- **Общее качество**: MAE < 7 лет ✅

### Ключевые достижения:
- ✅ **Цель достигнута**: MAE = 6.82 < 8 лет
- ✅ **Стабильное обучение**: Отсутствие переобучения
- ✅ **Быстрая сходимость**: Хорошие результаты к 4-й эпохе

##  Анализ результатов

### Сильные стороны модели:
- ✅ Высокая точность для возрастного диапазона 20-40 лет
- ✅ Хорошая обобщающая способность
- ✅ Быстрое время предсказания (подходит для реального использования)
- ✅ Устойчивость к небольшим изменениям в освещении и ракурсе

### Области для улучшения:
- ⚠️ Сложности с крайними возрастными группами (дети до 10, взрослые 60+)
- ⚠️ Зависимость от качества и освещения фотографий
- ⚠️ Влияние этнических особенностей на точность

### Возрастное распределение:
- **20-40 лет**: Наивысшая точность (основная группа в датасете)
- **Дети 1-10 лет**: Средняя точность (меньше данных для обучения)
- **Взрослые 60+ лет**: Наименьшая точность (редкие случаи в данных)

##  Практическое применение

### Для бизнеса:
1. **Персонализированные предложения**: Рекомендации товаров по возрастным группам
2. **Контроль продаж**: Автоматическая проверка возраста при продаже алкоголя
3. **Аналитика покупателей**: Статистика возрастного распределения клиентов
4. **Улучшение сервиса**: Оптимизация ассортимента под целевую аудиторию
